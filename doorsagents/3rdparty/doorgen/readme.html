<html>
<head>
<title>seodor.ru - мануал по доргену от andryha64</title>
</head>
<body>
<table border="1">
<tr><td colspan="2"><b>Табл 1. Описание параметров для настройки доргена. Устанавливаются в файле settings.xml</b></td></tr>
<tr><td colspan="2">Основные. Часто используемые</td></tr>
<tr><td>enable_limit</td><td>Включить/выключить лимит страниц на каждый дор из задания</td></tr>
<tr><td>job_file</td><td>Файл заданий. Должен лежать в папке из параметра jobs_dir</td></tr>
<tr><td>text_ancor_sitemap_links</td><td>Текст анкора в ссылках на карты дора. Генератор дополняет его номером карты в конце</td></tr>
<tr><td>text_ancor_index_link</td><td>Текст анкора в ссылке на главную страницу дора</td></tr>
<tr><td>count_ancor_in_map</td><td>Количество линков на странице карты сайта. Сами карты и их кол-во рассчитывается автоматически</td></tr>
<tr><td>num_perc_spam</td><td>Соотношение кол-ва страниц, взятых для спама, к общему кол-ву страниц. Т.е. 0.05 = 5%. Помещается затем в лог *_bbcode_log_spam.txt</td></tr>
<tr><td colspan="2">Дополнительные. Редко используемые</td></tr>
<tr><td>compression_template</td><td>Включить/выключить сжатие шаблона. Технически это "вытягивание" html в одну строку, удаление повторных пробелов и табов, в готовых страницах</td></tr>
<tr><td>extension</td><td>Расширение генерируемых страниц дора</td></tr>
<tr><td>keys_dir</td><td>Папка, откуда дорген возьмет ключевики</td></tr>
<tr><td>templ_dir</td><td>Папка, откуда дорген возьмет шаблоны</td></tr>
<tr><td>out_dir</td><td>Папка, куда дорген запишет результаты работы</td></tr>
<tr><td>jobs_dir</td><td>Папка, откуда дорген возьмет файл задания</td></tr>
<tr><td>text_dir</td><td>Папка, откуда дорген возьмет файлы текстовки для макроса {RAND_TEXT_x}, {LINE_FILE_x_y}, {DOR_TEXT_x} и прочих</td></tr>
<tr><td>insert_sitemaps_links_in_all_ancor_log</td><td>Включить/выключить вставку html ссылок на карты сайтов в лог all_ancor_log.txt</td></tr>
<tr><td>insert_sitemaps_links_in_ancor_log</td><td>Включить/выключить вставку html ссылок на карты сайтов в лог *_ancor_log.txt</td></tr>
<tr><td>insert_sitemaps_links_in_bbcode_log</td><td>Включить/выключить вставку ссылок в BB формате на карты сайтов в лог *_bbcode_log.txt</td></tr>
<tr><td>insert_sitemaps_links_in_bbcode_log_spam</td><td>Включить/выключить вставку ссылок в BB формате на карты сайтов в лог *_bbcode_log_spam.txt</td></tr>
<tr><td>generate_sitemap_xml</td><td>Включить/выключить генерацию файла sitemap.xml</td></tr>
<tr><td>generate_robots_txt</td><td>Включить/выключить генерацию файла robots.txt</td></tr>
<tr><td>generate_filezilla_project</td><td>Включить/выключить генерацию проекта для ftp-менеджера FileZilla (<i>временно не работает</i>)</td></tr>
<tr><td>enable_packing</td><td>Включить/выключить запаковку доров в zip</td></tr>
<tr><td>upload_ftp</td><td>Включить/выключить выгрузку на ftp</td></tr>
<tr><td>default_ftp_url</td><td>URL ftp по умолчанию. Используется, если не указано в задании<br>
Формат стандартный: ftp://username:password@test.com:port/path<br>
Путь указывать без / в конце<br>
port можно не указывать, тогда по-умолчанию подключение по 21 порту</td></tr>
<tr><td>extract_zip_archive</td><td>Включить/выключить автоматическую распаковку архива на сервере.<br>
Технически это происходит так:<br>
Создается файл out/[название_задания]_extract.php, в нем вписан алгоритм распаковывания архива и удаления затем самого архива и скрипта распаковщика<br>
Дорген заливает на хост архив доров и этот файл и пытается открыть его по адресу, указанному в параметре default_ftp_host<br>
После этого выводит "Успех" в случае если все распаковалось и удалилось. Все, ваши доры уже работают на хосте :)<br>
Внимание, хостинг должен поддерживать PHP</td></tr>
<tr><td colspan="2">Настройки редактора</td></tr>
<tr><td>editor_def_jobs_file</td><td>Значение по умолчанию для поля "Редактировать задание"</td></tr>
<tr><td>editor_def_templ_folder</td><td>Значение по умолчанию для поля "Редактировать шабы"</td></tr>
<tr><td>editor_def_keys_file</td><td>Значение по умолчанию для поля "Редактировать кеи"</td></tr>
<tr><td>editor_def_text_file</td><td>Значение по умолчанию для поля "Редактировать текстовки"</td></tr>
<tr><td>editor_def_delete_file</td><td>Значение по умолчанию для поля "Удалить файл"</td></tr><br>
</table>
<br>

<table border="1">
<tr><td colspan="2"><b>Табл 2. Описание макросов в порядке их замены в шаблоне</b></td></tr>
<tr><td>Макрос</td><td>Описание</td></tr>
<tr><td>[[x|y|z]]</td><td>Случайно выбирает текст. Или x, или y, или z. Можно указать много вариантов. Вложенные конструкции не допускаются. Правила расстановки макросов внутри вариатора читайте в FAQ п. 5</td></tr>
<tr><td>{НАЗВАНИЕ_МАКРОСА}</td><td>Пользовательские макросы. Название можно придумать любое, главное, предварительно определить его в файле templ/custom_macros.php</td></tr>
<tr><td>{FOR_x_y}z{/FOR}</td><td>Циклично вставляет текст z случайным количеством от x до y. Макросы внутри обрабатываются все, кроме {FOR} {/FOR}</td></tr>
<tr><td>{FOR_NUM}</td><td>Вставлет число текщего цикла. Работает <i>только внутри</i> макроса FOR. Пример: {FOR_x_y} {FOR_NUM} {/FOR}</td></tr>
<tr><td>{CURR_PAGE}</td><td>Номер текущей страницы дора, первая страница = 1, index не учитывается</td></tr>
<tr><td>{DOR_URL}</td><td>URL текущего дора</td></tr>
<tr><td>{DOR_HOST}</td><td>Хост текущего дора</td></tr>
<tr><td>{DOR_MEM_x}y{/DOR_MEM}</td><td>Запоминает результат или строку y под меткой x в пределах дора</td></tr>
<tr><td>{PAGE_RAND_x_y_z}</td><td>Случайное число от y до z одинаковое в пределах одной страницы, но разное в пределах всех страниц одного дора. Группируются в группы x. Числа генерируются до номера страницы (параметра z), далее макрос заменяется пустой строкой</td></tr>
<tr><td>{URAND_x_y}</td><td>Случайное число от x до y включительно. Уникальное значение в пределах одной страницы дора</td></tr>
<tr><td>{RAND_x_y}</td><td>Случайное число от x до y включительно. Не уникальное</td></tr>
<tr><td>{JOB_RAND_x_y_z}</td><td>Случайное число от y до z включительно с группой x, одно, в пределах всего задания</td></tr>
<tr><td>{CNT_x_y_z} {CNT_NUM} {/CNT}</td><td>Сквозной счетчик через все страницы дора с группой x начиная с числа y с шагом z. Внутри этой группы работает специальный макрос {CNT_NUM}, который заменяется на число счетчика.</td></tr>
<tr><td>{DOR_URAND_sign_x_y}</td><td>Случайное число от x до y включительно, одно, в пределах всего дора. Уникальные значения в пределах задания<br>
Метка sign может быть какой угодно фразой или числом. Она отвечает за разделение и идентификацию групп чисел</td></tr>
<tr><td>{DOR_RAND_sign_x_y}</td><td>Случайное число от x до y включительно, одно, в пределах всего дора. Не уникальные значения в пределах задания<br>
Метка sign может быть какой угодно фразой или числом. Она отвечает за разделение и идентификацию групп чисел</td></tr>
<tr><td>{LINKS_x_y_z}</td><td>Блок случайных ссылок на другие страницы текущего дора, случайным количеством от x до y включительно, с разделителем z. Уникальные в пределах одной страницы (учитываются ссылки из макросов {RAND_ANCOR} и {BRAND_ANCOR})</td></tr>
<tr><td>{BLINKS_x_y_z}</td><td>Блок случайных ссылок с анкором с заглавной буквы на другие страницы текущего дора, случайным количеством от x до y включительно, с разделителем z. Уникальные в пределах одной страницы (учитываются ссылки из макросов {RAND_ANCOR} и {BRAND_ANCOR})</td></tr>
<tr><td>{BBLINKS_x_y_z}</td><td>Блок случайных ссылок с анкором всех слов с заглавной буквы на другие страницы текущего дора, случайным количеством от x до y включительно, с разделителем z. Уникальные в пределах одной страницы (учитываются ссылки из макросов {RAND_ANCOR} и {BRAND_ANCOR})</td></tr>
<tr><td>{RELINKS_x_y_z}</td><td>Блок случайных ссылок на страницы других доров из задания, случайным количеством от x до y включительно, с разделителем z. Не уникальные в пределах одной страницы. Не вставляет ссылки на страницы на текущий дор</td></tr>
<tr><td>{RAND_KEY}</td><td>Случайный кей из списка кеев текущего дора. Уникальное значение в пределах одной страницы дора</td></tr>
<tr><td>{RAND_KEY_x_y_z}</td><td>Блок случайных кеев из списка кеев текущего дора, случайным количеством от x до y включительно, с разделителем z. Уникальное значение в пределах одной страницы дора</td></tr>
<tr><td>{BRAND_KEY_x_y_z}</td><td>Блок случайных кеев из списка кеев текущего дора, где первое слово начинается с заглавной буквы, случайным количеством от x до y включительно, с разделителем z. Уникальное значение в пределах одной страницы дора</td></tr>
<tr><td>{BBRAND_KEY_x_y_z}</td><td>Блок случайных кеев из списка кеев текущего дора, где все слова начинаются с заглавной буквы, случайным количеством от x до y включительно, с разделителем z. Уникальное значение в пределах одной страницы дора</td></tr>
<tr><td>{RAND_URL}</td><td>Случайный url на страницу текущего дора. Уникальное значение в пределах одной страницы дора. Не путать со ссылкой</td></tr>
<tr><td>{RAND_ANCOR}</td><td>Случайная ссылка на другую страницу текущего дора. Уникальное значение в пределах одной страницы дора</td></tr>
<tr><td>{BRAND_ANCOR}</td><td>Случайная ссылка на другую страницу текущего дора с анкором с заглавной буквы. Уникальное значение в пределах одной страницы дора</td></tr>
<tr><td>{BBRAND_ANCOR}</td><td>Случайная ссылка на другую страницу текущего дора, где все слова начинаются с заглавной буквы. Уникальное значение в пределах одной страницы дора</td></tr>
<tr><td>{MAPS_z}</td><td>Ссылки сгенерированных карт сайта, с разделителем z</td></tr>
<tr><td>{PREV_PAGE_x_y}</td><td>Ссылки на предыдущие страницы количеством x с разделителем y</td></tr>
<tr><td>{NEXT_PAGE_x_y}</td><td>Ссылки на последующие страницы количеством x с разделителем y</td></tr>
<tr><td>{MKEYWORD}</td><td>Главный кей дора с маленькой буквы</td></tr>
<tr><td>{BMKEYWORD}</td><td>Главный кей дора с заглавной буквы</td></tr>
<tr><td>{BBMKEYWORD}</td><td>Главный кей дора, где все слова начинаются с заглавной буквы</td></tr>
<tr><td>{KEYWORD}</td><td>Кей страницы с маленькой буквы</td></tr>
<tr><td>{BKEYWORD}</td><td>Кей страницы с заглавной буквы</td></tr>
<tr><td>{BBKEYWORD}</td><td>Кей страницы, где все слова начинаются с заглавной буквы</td></tr>
<tr><td>{INDEX}</td><td>Ссылка на главную страницу текущего дора, с анкором с заглавной буквы</td></tr>
<tr><td>{INDEX_x}</td><td>Ссылка на главную страницу дора под номером x из файла заданий</td></tr>
<tr><td>{MAP_LINKS_z}</td><td>Блок ссылок на все страницы дора по порядку, с разделителем z. Макрос обрабатывается только в шаблоне map.txt</td></tr>
<tr><td>{RAND_TEXT_x}</td><td>Случайная строка из файла x. Уникальное значение в пределах одной страницы дора</td></tr>
<tr><td>{RAND_TEXT_w_x_y_z1_z2}</td><td>Детальнее: {RAND_TEXT_имя файла.txt_минимальное количество строк_максимальное количество строк_внутренний разделитель_внешний разделитель}<br>
Случайные блоки текста из файла w, случайным количеством от x до y включительно, с <i>внутренним разделителем</i> z1 и <i>внешним разделителем</i> z2. Макросы также обрабатываются в этих строках.<br>
Внутренним разделителем z1 называется разделитель блоков текста в файле w. Для выборки строк из файла (блок здесь будет строкой) используйте разделитель \n. Для разделения не по строкам а по произвольным блокам придумайте свой внутренний разделитель, например, {END}. Тогда в исходном файле вам необходимо проставить границы блоков этими метками.<br>
Внешним разделителем z2 называется разделитель, который визуально разделит выводимые блоки в сгенерированных страницах<br>
{RAND_TEXT_123.txt_1_1_\n_} - эта запись макроса полностью соответствует записи {RAND_TEXT_123.txt}</td></tr>
<tr><td>{DOR_TEXT_x}</td><td>Вставляет строку из файла x, под номером, соответствующим номеру дорвея из списка заданий. Макросы также обрабатываются в этих строках<br>
Пример: в файле заданий два задания, т.е. два дорвея. В шаблоне этот макрос указываем так: {DOR_TEXT_count.txt}<br>
При генерации первого дора из списка заданий, дорген заменит макрос на первую строку из "text/count.txt"<br>
При генерации второго дора из списка заданий, дорген заменит макрос на вторую строку из "text/count.txt" и так далее</td></tr>
<tr><td>{LINE_FILE_x_y}</td><td>Берет из файла x строку номер x (первая строка: x = 1). Макросы также обрабатываются в этих строках</td></tr>
<tr><td>{MIX_TEXT_x_y_z}</td><td>Берет все строки из файла x с <i>внутренним разделителем</i> y и <i>внешним разделителем</i> z в случайном порядке</td></tr>
<tr><td>{DOR}</td><td>Вставляет название дора, полученное преобразованием первого ключевого слова в понятную ФС запись. Макрос обрабатывается только в файле заданий jobs/*.txt</td></tr>
<tr><td>{MEM_x}y{/MEM}</td><td>Запоминает результат или строку y под меткой x в пределах одной страницы</td></tr>
<tr><td>{INS_x}</td><td>Вставляет результат или строку под меткой x. Работает в связке с MEM</td></tr>
<tr><td>{NUM_SITEMAP}</td><td>Вставляет номер текущей карты сайта</td></tr>
</table>
<br>

<table border="1">
<tr><td colspan="7"><b>Табл 3. Где выполняются макросы</b></td></tr>
<tr><td>Имя макроса</td><td>index.txt</td><td>page.txt</td><td>map.txt</td><td>t_*.*</td><td>jobs/*.txt</td><td>Текст анкора на sitemap'ы</td></tr>
<tr><td>ПОЛЬЗОВАТЕЛЬСКИЕ_МАКРОСЫ</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>

<tr><td>FOR /FOR</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>
<tr><td>[[|]]</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td></tr>
<tr><td>URAND</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>

<tr><td>RAND</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td></tr>
<tr><td>DOR_URAND</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>
<tr><td>DOR_RAND</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>

<tr><td>RAND_TEXT, BRAND_TEXT, BBRAND_TEXT</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td></tr>
<tr><td>DOR_TEXT</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td></tr>
<tr><td>LINE_FILE</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td></tr>

<tr><td>LINKS, BLINKS, BBLINKS</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>
<tr><td>RELINKS</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>
<tr><td>RAND_KEY</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td>+</td></tr>

<tr><td>RAND_URL</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>
<tr><td>RAND_ANCOR</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>
<tr><td>MAPS</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>

<tr><td>PREV_PAGE</td><td></td><td>+</td><td></td><td></td><td></td><td></td></tr>
<tr><td>NEXT_PAGE</td><td>+</td><td>+</td><td></td><td></td><td></td><td></td></tr>
<tr><td>MKEYWORD, BMKEYWORD, BBMKEYWORD</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td>+</td></tr>
<tr><td>KEYWORD, BKEYWORD, BBKEYWORD</td><td>+</td><td>+</td><td></td><td></td><td></td><td></td></tr>

<tr><td>INDEX</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>
<tr><td>MAP_LINKS</td><td></td><td></td><td>+</td><td></td><td></td><td></td></tr>
<tr><td>MIX_TEXT</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>
<tr><td>CURR_PAGE</td><td></td><td>+</td><td></td><td></td><td></td><td></td></tr>

<tr><td>DOR_URL</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td>+</td></tr>
<tr><td>DOR_HOST</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td>+</td></tr>
<tr><td>MEM /MEM, INS</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td></tr>

<tr><td>PAGE_RAND</td><td></td><td>+</td><td></td><td></td><td></td><td></td></tr>
<tr><td>CNT /CNT</td><td>+</td><td>+</td><td></td><td></td><td></td><td></td></tr>
<tr><td>DOR_MEM /DOR_MEM, DOR_INS</td><td>+</td><td>+</td><td>+</td><td>+</td><td></td><td></td></tr>
<tr><td>JOB_RAND</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td></tr>

<tr><td>NUM_SITEMAP</td><td></td><td></td><td>+</td><td></td><td></td><td></td></tr>
<tr><td>DOR</td><td></td><td></td><td></td><td></td><td>+</td><td></td></tr>
</table>
Для примера сгенерируйте тестовый дор из тестовых шаблонов, кеев и текстовки<br>
Каждый шаблон состоит из трех файлов, это index.txt - главная страница, page.txt - все остальные страницы и map.txt - шаблон карты<br>
Поддерживается неограниченное кол-во пользовательских страниц. Пользовательские страницы должны располагаться в папке с шаблоном и иметь префикс t_ , который после генерации уберается, и остается только название файла с расширением<br>
Пользовательские страницы не включаются в файлы перелинковки, sitemap.html, sitemap.xml, в отчеты для спама и в перелинковку разными макросами!<br>
Каждый шаблон имеет свою папку для идентификации<br><br>

<b>Подготовка файла заданий</b><br>
Идем в папку в заданиями. Создаем файл с заданиями, например, test.txt (см. пример)
<table border="1">
<tr><td>1</td><td>test.txt</td><td>100</td><td>1</td><td>[[test_macros1|test_macros2|test_macros3]]</td><td>http://{DOR_TEXT_subdor.txt}.test.com/{DOR}</td><td>mydor/{DOR}</td></tr>
<tr><td>Номера доров из задания, с которыми будет перелинкован дор, посредством макроса RELINKS</td><td>Имя файла с ключами</td><td>Кол-во клюей для генерации</td><td>Включить/выключить перемешивание кеев (1- вкл, 0-выкл)</td><td>Применяемый шаблон</td><td>Будущий url дора, без / в конце</td><td>Расположение в локальной папке out, без слешей в конце!</td></tr>
</table>
Каждая строчка - это дор в пачке. Каждый файл заданий это пачка доров<br>
URL будущего дора может задаваться как угодно, например:<br>
http://test.com/{DOR} - это значит, что дор будет в папке<br>
http://{DOR}.test.com - это значит, что дор будет в сабдомене<br>
Каждый параметр разделяется запятой, всего семь параметров на данный момент<br>
Можно использовать комментарии /*<br>
Можно использовать макросы, они работают в любом параметре (табл. 3)<br><br>

<b>Внешняя перелинковка в заданиях</b><br>
Первый параметр каждого дора из задания - это номера дора из текущего задания, с которыми будет перелинкован текущий дор макросом RELINKS<br>
Нумерация начинается с 1. Разделитель между номерами - пробел. Пример параметра:<br>
1 2 3 8 9 - означает, что текущий дор будет использовать для перелинковки макросом RELINKS случайные страницы доров под номерами 1, 2, 3, 8 и 9<br>
Если указать здесь просто "0" (без кавычек), то этот дор ни с чем линковаться не будет. И макрос RELINKS в шаблоне будет заменятся пустой строкой<br>
Если первый параметр не указывать совсем, то это дает понять доргену, что этот дор может ссылаться на все доры из задания, кроме самого себя<br>
Для чего была придумана сея замудренка? Для хитровыдуманных доров. Можно теперь осуществлять псевдо категории, тонко настраивая внешнюю перелинковку между дорами/категориями<br><br>

<b>Файловая структура доргена</b><br>
Папка jobs - содержит файлы заданий<br>
Папка keys - содержит файлы ключей<br>
Папка lib - содержит служебные файлы доргена<br>
Папка templ - содержит папки шаблонов<br>
Папка text - содержит файлы текстовок<br>
Папка out - содержит файлы сгенерированных доров<br>
Файл engine.php - главный файл доргена, вся логика описана здесь<br>
Файл index.php - редактирование настроек<br>
Файл settings.xml - файл со всеми настройками<br>
Файл readme.html - этот файл, привязанный к конкретной версии<br><br>

<b>Генератор заданий для ленивых (не работает в новых версиях)</b><br>
Находится в папке jobs и называется jobs_gen.php<br>
Редактируются параметры:<br>
$job_file - название будущего файла заданий<br>
$templ - название шаблона/шаблонов<br>
$url - будущий url дора без / в конце<br>
$path - локальный путь дора без / в конце<br>
Работает так:<br>
Запускаем скрипт, он формирует строки заданий, изменяя только названия файла ключей<br>
Таким образом можно автоматически нагенерить задания для большой пачки доров<br><br>

<b>Установка и запуск</b><br>
Установка - простое копирование всех папок и файлов<br>
Запускать index.php<br><br>

<b>Кратко логика работы доргена</b>
<ol style="margin:0px">
<li>Берет файл задания. Читает кеи из файлов. Фильтрует дубли по определенной технологии</li>
<li>Составляет анкор листы</li>
<li>Копируются все объекты из папки с шаблона в папку с дором, кроме файлов index.txt, page.txt и map.txt</li>
<li>В каждом доре автоматически создаются карты sitemap в виде html страницы и sitemap.xml, а также robots.txt</li>
<li>Генерирует каждый дор. Причем директория дора, и ключ главной страницы - это первый ключ в списке ключей</li>
<li>Генерируются пользовательские странички</li>
<li>Генерируются index.txt, page.txt</li>
<li>Вся пачка доров запаковывается в один архив и помещается в папку out/[название-задания].zip</li>
<li>Архив с дорами и файл распаковки выгружается на ftp сервер</li>
<li>На сервере происходит: распаковка архива, удаление архива и скрипта распаковщика. Работает если сервер поддерживает PHP</li>
<li>Логи пачки доров сохраняются в папку out/[название-задания]_log.txt</li>
</ol><br>

<b>Порядок замены макросов в шаблоне</b>
<ol style="margin:0px">
<li>NUM_SITEMAP</li>
<li>[[|]]</li>
<li>Пользовательские макросы</li>
<li>FOR /FOR</li>
<li>CURR_PAGE</li>
<li>DOR_URL</li>
<li>DOR_HOST</li>
<li>PAGE_RAND</li>
<li>URAND</li>
<li>RAND</li>
<li>DOR_URAND</li>
<li>DOR_RAND</li>
<li>CNT /CNT</li>
<li>LINKS, BLINKS, BBLINKS</li>
<li>RELINKS</li>
<li>RAND_KEY, BRAND_KEY, BBRAND_KEY</li>
<li>RAND_URL</li>
<li>RAND_ANCOR, BRAND_ANCOR, BBRAND_ANCOR</li>
<li>MAPS</li>
<li>PREV_PAGE</li>
<li>NEXT_PAGE</li>
<li>MKEYWORD, BMKEYWORD, BBMKEYWORD</li>
<li>KEYWORD, BKEYWORD, BBKEYWORD</li>
<li>INDEX</li>
<li>MAP_LINKS</li>
<li>RAND_TEXT, BRAND_TEXT, BBRAND_TEXT</li>
<li>DOR_TEXT</li>
<li>LINE_FILE</li>
<li>MIX_TEXT</li>
<li>MEM, INS</li>
<li>DOR_MEM, DOR_INS</li>
</ol>
Эти данные можно использовать для составления макросов в макросе (вложенность). Смотрите тестовый шаблон<br><br>

<b>Порядок обработки шаблонов в доргене</b>
<ol style="margin:0px">
<li>Генерируются карты дора (map.txt)</li>
<li>Генерируются пользовательские странички (t_*.txt)</li>
<li>Генерируется индекс (index.txt)</li>
<li>Генерируются остальные страницы (page.txt)</li>
</ol>
Эти данные очень важны при использовании максроса DOR_MEM /DOR_MEM, DOR_INS<br>
DOR_MEM <i>всегда</i> должен быть использован раньше, чем DOR_INS в этой ступени, иначе дорген зависнет. Такую ошибку зависания определить гораздо сложнее<br><br>

<b>Некоторые особенности генератора</b>
<ul style="margin:0px">
<li>Генерирует уникальные значения в пределах одной генерируемой страницы специальными макросами</li>
<li>Работает как с бурж кеями, так и с русскими (транслит) без дополнительных шаманств</li>
<li>На данном этапе не имеет веб-интерфейса настроек, все настраивается в файле settings.xml</li>
<li>Авто разбитие карты по заданному количеству ссылок с одной карты</li>
<li>Авто сбор ссылок для спама по заданному соотношению. Сразу в BB код для удобства</li>
<li>Рекурсивная обработка некоторых макросов в тексте, которые вставляется с помощью других макросов</li>
<li>Перелинковывает все страницы всех доров вперемешку. Т.е. первый дор "знает" и может ссылаться на последний из пачки</li>
<li>Если карта сайта (sitemap.html) генерируется одна, в текст анкора не добавляется номер карты</li>
<li>Поддерживает генерацию пользовательских страниц в любом количестве</li>
<li>Автоматически выгружает zip архив пачки доров на хост по ftp. Опционально</li>
<li>Автоматически распаковывает архив с дорами на сервере. Опционально</li>
<li>Автоматически копирует все объекты из папки с шаблона в папку с дором</li>
<li>Можно формировать любую удобную для вас структуру доров в папках</li>
</ul><br>

<b>FAQ</b>
<ol style="margin:0px">
<li>Как осуществить перелинковку с ранее сгенеренными пачками доров?<br>
<p style="margin:7px">При генерации пачки доров, дорген создает три отчета в папке out. На нужен отчет [название-задания]_ancor_log.txt. В нем содержится список линков с абсолютными путями на все страницы всех доров нужной вам пачки.<br>
Берем этот отчет [название-задания]_ancor_log.txt, копируем в папку текстовок text. И в шаблоне новой пачки просто прописываем макрос {RAND_TEXT_[название-задания]_ancor_log.txt}<br>
Дорген будет брать случайную строку из файла, а значит вставлять на страницу случайный линк на случайную страницу случайного дора нужной вам пачки</p></li>
<li>Почему дорген иногда зависает надолго, до перезагрузки больше ничего не генерит?<br>
<p style="margin:7px">Если вы часто используете макросы, генерирующие уникальные подстановки, следите, чтобы кол-во выходных данных было не более количества входных данных во всех шаблонах и подключаемых файлах, а также пользовательских макросах и пр.<br>
Когда генератор исчерпывает все неиспользованные значения, пытаясь найти их, он зависает<br>
Небольшой пример, при котором генератор зависнет (прописываем в шаблоне):<br>
{URAND_8_10}, {URAND_8_10}, {URAND_8_10} и {URAND_8_10}<br>
Первый раз сгенерировал 9 (и запомнил его), второй раз 8 (и запомнил его), третий раз 10 (и запомнил его). На четвертый все уникальные неиспользованные значения из заданного диапазона от 8 до 10 исчерпаны. Генератор завис. Занавес..</p></li>
<li>В файле ключей у меня 100 ключей, но дорген упорно берет только 90, хотя дублей ключей в файле нет (числа условны). Почему так происходит?<br>
<p style="margin:7px">В доргене реализована собственная функция удаления дублей ключей, дабы избежать склейки страниц или даже целых папок доров.<br>
Кратко про алгоритм: дорген преобразовывает каждый ключ в имя файла, затем удаляет дубли уже из списка преобразованных значений и дальше использует ключи, которые соответствуют непустым значениям преобразованных ключей. Немного запутанно, поясню на примере:<br>
В файле ключей у нас с новой строки следующие ключи: диван-кровать, шкаф-купе, диван кровать, шкаф купе<br>
На первый взгляд дублей нет и любая программа которая сравнивает дубли по строкам их не удалит, посмотрим, что происходит при подготовке ключей доргеном:<br>
Он преобразовывает каждый ключ в имя файла: divan-krovat, hkaf-kupe, divan-krovat, hkaf-kupe (так как символ пробела преобразовывается в тире, а тире так и остается). Далее дорген удаляет дубли в уже преобразованном файле, т.е. получается так: divan-krovat, hkaf-kupe. И берет в генерацию только первые вхождения каждого дублирующегося ключа, т.е. возьмет: диван-кровать, шкаф-купе</p></li>
<li>Почему у меня несколько sitemap генерируется, а не одна карта?<br>
<p style="margin:7px">Потому, что карта разбивается на несколько карт по формуле: <i>кол-во страниц</i>/<i>параметр count_ancor_in_map</i>. Если вам необходима одна карта, укажите в параметре count_ancor_in_map заведомо большое число, например 9999</p></li>
<li>По вероятности выбора условного макроса [[|]]<br>
<p style="margin:7px">Дорген всегда начинает выбор с самого внутреннего вариатора, и идет с заменой к самому внешнему. Отсюда вывод: внутренние варианты имеют шанс значительно меньший, чем внешние выйти на страницу. Рассмотрим пример [[one|[[1|2|[[3|4|5]]]]]]:<br>
<pre>
 50%        50%
one | [[1|2|[[3|4|5]]]]

17% 17%   16%
1 | 2 | [[3|4|5]]

6%  5%  5%
3 | 4 | 5
</pre></p></li>
</ol><br>
FAQ дополняется из ваших вопросов на форуме и в аське<br><br>

<b>Поддержка скрипта</b><br>
Скрипт бесплатный на данном этапе<br>
Пожелания для доработки и исправления найденных багов очень приветствуются<br>
Ответы на ваши вопросы <a href='http://edu.jonn22.com/forum/showthread.php?t=336' target='_blank'>edu.jonn22.com/forum</a> и в <script>var a=4; var b=3; var c=-7; document.write('icq '+b+'21'+'-'+'8'+a+c+a);</script><br>
Вы также можете пожертвовать любую сумму в качестве благодарности: <a href="wmk:payto?Purse=Z734397091314&Amount=1&Desc=Спасибо за дорген, Андрюха)&BringToFront=Y">1 WMZ</a>, <a href="wmk:payto?Purse=Z734397091314&Amount=3&Desc=Спасибо за дорген, Андрюха)&BringToFront=Y">3 WMZ</a>, <a href="wmk:payto?Purse=Z734397091314&Amount=5&Desc=Спасибо за дорген, Андрюха)&BringToFront=Y">5 WMZ</a>, <a href="wmk:payto?Purse=Z734397091314&Amount=1000000&Desc=Держи миллион Андрюха, ты это заслужил)&BringToFront=Y">1000000 WMZ</a><br>
<b>Спасибо за использование моего доргена. Всегда свежую версию вы можете найти здесь <a href='http://seodor.ru/dorgen/' target='_blank'>http://seodor.ru/dorgen/</a></b>
</body>
</html>